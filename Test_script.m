%% Capita - Tests script
%
%
%% A

A = [3 1 -1 0 0 0 0;
     0 4 0.5 0 0 0 0;
     0 0 -1 0 -0.5 0 0;
     0 0 0 2 0 2 0;
     0 0 0 0 5 1 0;
     0 0 0 0 0 3 0;
     0 0 0 0 0 0 0];

[V_a, D_a] = eig(A);
%A
%[ 0.0207737 -0.0414434 -0.0829562 1.37967e-10 0.995474 6.89835e-11 0 ]
%CHECK
tA = A'*A;
[V_ta, D_ta] = eig(tA);
% AtA
%[ -0.00294474 0.0010017 0.0189345 0.0634814 0.927064 0.368991 0 ]
%CHECK
At = A*A';
[V_at, D_at] = eig(At);
% AtA
%[ -0.00294474 0.0010017 0.0189345 0.0634814 0.927064 0.368991 0 ]
%CHECK
%% B - Symmetric
B = [0 0 0 0 15;
     0 0 23 24 0;
     0 23 0 0 35;
     0 24 0 0 0;
     15 0 35 0 0];
 
[V_b, D_b] = eig(B);

%[ 0.185258 0.431061 0.661911 0.239625 0.533217 ]
%CHECK

%% Tests

%Test 1 - symmetric
crs = mmread('m_05_05_crs.mm');

[V_cpg, D_cpg] = eigs(crs);

%[ 0.145045 0.268193 0.593182 0.151657 0.7295 ]
%CHECK

%Test 2 - symmetric 
test2 = mmread('test2.mtx');

[V_t2, D_t2] = eigs(test2);

%[ 0.0217993 -0.00620286 -0.0644194 0.278753 0.809777 0.511756 0 ]
%CHECK

%Test 3 - general
test3 = mmread('test3.mm');

[V_t3, D_t3] = eigs(test3);

%[ 0.154372 0.502139 0.7204 3.85219e-05 0.452823 ]
%CHECK

test3_ta = test3'*test3;

[V_at3, D_at3] = eigs(test3_ta);

%[0.0320367 0.0507844 0.349218 0.0914205 0.930636 ]
%CHECK

test3_ta = test3*test3';

[V_ta3, D_ta3] = eigs(test3_ta);

%[ 0.204163 0.161819 0.629046 0.0573856 0.730164 ]
%CHECK

%Test 4 
test4 = mmread('ex5.mtx');
 
[V_t4, D_t4] = eigs(test4);


% [ -0.0720853 -0.0651853 -0.188656 -0.105449 -0.233141 -0.105449 -0.188656 
%     -0.0651853 -0.0720853 0.144171 0.13037 0.377312 0.210898 0.466282 0.210898 
%     0.377312 0.13037 0.144171 -0.0720853 -0.0651853 -0.188656 -0.105449 -0.233141 
%     -0.105449 -0.188656 -0.0651853 -0.0720853 ]
%CHECK






